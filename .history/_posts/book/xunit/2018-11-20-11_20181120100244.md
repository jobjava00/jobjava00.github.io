---
layout: archive
title: "[xUnit 테스트 패턴] 11장 - 테스트 대역 사용"
date: 2018-11-20
excerpt: ""
tags: [book, xunit, xUnit 테스트 패턴, 테스트 대역 사용]
category: [book/xunit]
#read_time: true
#share: true

sidebar:
  nav: "book"
---

* * *

# 11장 - 테스트 대역 사용

## 간접 입력과 간접 출력

* 의존 컴포넌트의 리턴 값이나 예외를 실제로 발생시키기 어려울 때 테스트 대역으로 해결 할 수 있다.

### 간접 입력을 신경 써야 하는 이유

* SUT 내부의 여러 실행 경로가 DOC를 호출 후 리턴 값이나 예외를 처리하기 위한 목적으로 마련 됨
  * 이런 경로들을 테스트하지 않고 둔다면 `테스트 안 된 코드`가 된다.
* DOC에서 발생시키고자 하는 예외가 `간접 입력 테스트 조건의 좋은 예`

### 간접 출력을 신경 써야 하는 이유

* 뒷문 테스트 해야 하는 경우
  * 메시지 로깅
* 간접 출력 테스트 조건
  * 메시지가 로그로 남게 되는 환경
* 일부 간접 출력은 메소드 호출이나 메시지 형태로 다른 컴포넌트에 전달 된다.

### 간접 입력은 어떻게 제어할 수 있을까

* 자신이 원하는 모든 유형의 리턴 갑을 DOC가 리턴하게 제어할 수 있어야 한다.
* 제어 위치를 통해 발생시키고 싶은 간접 입력의 유형
  * 메소드/함수의 러턴 값
  * 변경 가능한 인자 값(pass-by-reference로 전달한 함수 인자)
  * 예상되는 예외
* `테스트스텁`으로 함수가 원하는 값을 리턴하게 설정한 후 이를 SUT에 설치
  * SUT가 실행되는 동안 테스트 스텁은 함수 호출을 받아 이전에 설정된 값을 리턴한다.

### 간접 출력은 어떻게 검증할 것인가

* 간접 출력을 테스트하려면 SUT가 호출하는 DOC의 API를 관찰할 수 있어야 한다.
  * 리턴 값도 제어할 수 있어야 한다.
* 간접 출력 검증 두 가지 방식
  * 절차형 동작 검증
    * SUT가 실행되는 동안 특정 DOC로의 호출을 잡아내 SUT 실행이 끝난 후 원하는 대로 호출됐는지를 검사
  * 기대 동작 검증
    * 테스트의 픽스처 설치 단계에서 `동작 명세`를 만든 후 이를 실제 동작과 비교

### 대역으로 테스트하기
