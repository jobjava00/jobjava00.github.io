---
layout: archive
title: "[xUnit 테스트 패턴] 15장 - 코드 냄새"
date: 2018-11-27
excerpt: ""
tags: [book, xunit, xUnit 테스트 패턴, 코드 냄새]
category: [book/xunit]
#read_time: true
#share: true

sidebar:
  nav: "book"
---

* * *

# 15장 - 코드 냄새

## 애매한 테스트

### 증상 : 애매한 테스트

* 테스트를 한눈에 이해하기 어렵다.

### 미치는 영향 : 애매한 테스트
  
* 이해하기 어렵고 유지 보수하기도 어렵다.
* 문서로서의 테스트 만들기 업려고, 높은 테스트 유지 비용이 발생 할 수 있다.
* 버그 투성이 테스트, 욕심쟁이 테스트가 될 수 있다.

### 원인 : 애매한 테스트

* 테스트 메소드에 정보가 너무 많거나 적을 때 발생
* 욕심쟁이 테스트
  * 하나의 테스트 메소드에 너무 많은 기능을 검증하려는 테스트
* 미스터리한 손님
  * 픽스처와 검증 로직의 일부가 테스트 바깥에 있어 코드에서 이들 간의 인과 관계가 보이지 않는 테스트
* 장황한 테스트(Verbose Test)의 일반적인 문제점
  * 일반 픽스처 - 필요 이상으로 큰 픽스처 생성 or 참조
  * 관련 없는 정보
  * 하드 코딩된 테스트 데이터
  * 간접 테스트

#### 원인 : 욕심쟁이 테스트

* 하나의 테스트 메소드에서 너무 많은 기능을 검증하려는 테스트

#### 증상 : 욕심쟁이 테스트

* `없는 거 뺴고 전부 다 검증`
* 어디까지가 픽스처 설치, 어디서부터 SUT 실행인지 알기 어려움
  * SUT 실행 및 검증을 여러 단계에 거쳐서 함

#### 근본 원인 : 욕심쟁이 테스트

* 수동 테스트 시 테스트할 때마나 설치하는 고생을 줄이기 위해 별개의 테스트 조건들이라도 하나의 테스트 케이스에 전부 몰아넣어도 된다.

#### 해결책 : 욕심쟁이 테스트

* 자동화 된 테스트라면 결함 국소화를 위해 단일 조건 테스트 스위트로 만드는게 낫다.

#### 원인 : 미스터리한 손님

* 테스트 스파이
  * 자신이 어떻게 호출됐는지를 `기억`했다가 단언 메소드에서 비교
* 모의 객체
  * 픽스처 설치 시 기대 값을 담고 SUT가 실행되는 동안 실제 호출이 들어오면 이를 기대 값과 비교
